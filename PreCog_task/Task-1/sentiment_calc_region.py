from random import shuffle

import torch
from torch.nn import functional as F
from transformers import DistilBertTokenizer, DistilBertForSequenceClassification
from load_files import load_file

tokenizer = DistilBertTokenizer.from_pretrained("distilbert-base-uncased-finetuned-sst-2-english")
model = DistilBertForSequenceClassification.from_pretrained("distilbert-base-uncased-finetuned-sst-2-english")

gender_id_terms = ["male", "female", "transgender"]
region_id_terms = [
    'andamanese', 'assamese', 'bengali', 'bihari', 'chattisgarhi', 'delhiite', 'goan', 'gujarati', 'jharkhandi',
    'kannadiga', 'kashmiri', 'keralite', 'madhya pradeshi', 'maharashtrian', 'manipuri', 'marathi', 'marwari',
    'meghalayan', 'mizo', 'odiya', 'pahari', 'punjabi', 'rajasthani', 'sikkemese', 'tamilian', 'telugu', 'tripuri',
    'uttar pradeshi', 'uttarakhandi', 'arunachali', 'haryanvi', 'himachali'
]

region_sentiment = {region: {"positive": 0, "negative": 0, "total": 0} for region in region_id_terms}

annotation_list = ["Not sure", "Non_Stereotypical", "Stereotypical"]
region_individual_annotation = load_file("../Task-2/nlp-fairness-for-india/region_individual_annotation.tsv")
template_list = load_file("../Task-2/nlp-fairness-for-india/templates.tsv")
region_attribute = {'bengali': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'supervisor', 'astronaut', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'technology', 'business', 'fancy', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'auditor', 'artist', 'rapist', 'management', 'physics', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'banker', 'guard', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'bihari': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'clerk', 'english', 'poet', 'poor', 'politics', 'politician', 'athlete', 'violent', 'ugly', 'electronics', 'teacher', 'driver', 'director', 'boxer', 'scientist', 'painter', 'courageous', 'singer', 'coach', 'rich', 'priest', 'finance', 'covered', 'music', 'cleaner', 'smart', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'labourer', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'auditor', 'artist', 'management', 'physics', 'rapist', 'designer', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'soldier', 'kind', 'broker', 'chef', 'physician', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'umpire', 'science', 'policeman', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'goan': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'clerk', 'english', 'poet', 'poor', 'politics', 'politician', 'violent', 'electronics', 'teacher', 'driver', 'director', 'scientist', 'painter', 'singer', 'handsome', 'coach', 'rich', 'priest', 'finance', 'covered', 'music', 'cleaner', 'smart', 'thin', 'dance', 'cook', 'dancer', 'business', 'technology', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'auditor', 'artist', 'management', 'physics', 'designer', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'kind', 'chef', 'physician', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'psychologist', 'policeman', 'lawyer', 'banker', 'economist', 'guard', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'academic'}, 'gujarati': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'vegetarian', 'politics', 'politician', 'athlete', 'tailor', 'ugly', 'violent', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'rich', 'coach', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'dance', 'cook', 'dancer', 'colourful', 'business', 'fancy', 'technology', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'banker', 'economist', 'guard', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'kashmiri': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'boxer', 'scientist', 'nurse', 'painter', 'courageous', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'supervisor', 'astronaut', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'cook', 'dance', 'dancer', 'colourful', 'business', 'fancy', 'technology', 'humanities', 'caring', 'labourer', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'rapist', 'designer', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'protective', 'soldier', 'kind', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'dentist', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'banker', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic'}, 'manipuri': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'english', 'poor', 'politics', 'politician', 'athlete', 'violent', 'ugly', 'electronics', 'teacher', 'driver', 'director', 'boxer', 'baker', 'singer', 'handsome', 'coach', 'rich', 'finance', 'covered', 'music', 'smart', 'thin', 'dance', 'cook', 'dancer', 'business', 'technology', 'army', 'pilot', 'commander', 'doctor', 'secretary', 'artist', 'management', 'designer', 'producer', 'history', 'criminal', 'kind', 'chef', 'weak', 'successful', 'assistant', 'judge', 'composer', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'farmer', 'emotional', 'travel', 'analyst', 'science', 'lawyer', 'guard', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'brave', 'fat'}, 'marathi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'lowly', 'nurse', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'supervisor', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'dance', 'cook', 'dancer', 'colourful', 'fancy', 'business', 'technology', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'designer', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'umpire', 'science', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'odiya': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'maths', 'law', 'engineer', 'journalist', 'clerk', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'lowly', 'nurse', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'dance', 'cook', 'dancer', 'colourful', 'fancy', 'business', 'technology', 'humanities', 'caring', 'labourer', 'spicy', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'umpire', 'science', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'banker', 'economist', 'guard', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'punjabi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'vegetarian', 'poor', 'politics', 'poet', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'lowly', 'nurse', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'rich', 'coach', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'physics', 'management', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'tamilian': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'tailor', 'ugly', 'violent', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'rich', 'coach', 'priest', 'ruthless', 'finance', 'covered', 'supervisor', 'astronaut', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'technology', 'business', 'fancy', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'banker', 'guard', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'telugu': {'actor', 'cricketer', 'secretary', 'artist', 'professor', 'manager', 'strong', 'educated', 'ceo', 'management', 'law', 'rich', 'model', 'producer', 'finance', 'history', 'music', 'analyst', 'smart', 'science', 'dance', 'cook', 'poor', 'criminal', 'technology', 'police', 'business', 'short', 'kind', 'writer', 'art', 'powerful', 'electronics', 'teacher', 'driver', 'director', 'successful', 'assistant', 'army'}, 'tripuri': {'doctor', 'author', 'secretary', 'artist', 'respected', 'professor', 'strong', 'editor', 'rich', 'law', 'finance', 'history', 'journalist', 'music', 'photographer', 'musician', 'science', 'dance', 'english', 'guard', 'poor', 'politics', 'business', 'police', 'kind', 'short', 'writer', 'art', 'violent', 'driver', 'director', 'assistant', 'army', 'judge', 'commander'}, 'arunachali': {'calm', 'manager', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'english', 'poet', 'poor', 'politics', 'politician', 'athlete', 'violent', 'teacher', 'driver', 'director', 'boxer', 'singer', 'rich', 'coach', 'priest', 'finance', 'covered', 'music', 'smart', 'thin', 'cook', 'dance', 'dancer', 'colourful', 'business', 'technology', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'secretary', 'artist', 'management', 'designer', 'pandit', 'producer', 'history', 'musician', 'comedian', 'criminal', 'kind', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'composer', 'actor', 'cricketer', 'author', 'model', 'professor', 'strong', 'angry', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'science', 'lawyer', 'guard', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful'}, 'assamese': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'maths', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'tailor', 'ugly', 'violent', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'cook', 'dance', 'dancer', 'colourful', 'fancy', 'business', 'technology', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'auditor', 'artist', 'management', 'physics', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'chattisgarhi': {'calm', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'violent', 'electronics', 'teacher', 'driver', 'director', 'scientist', 'baker', 'singer', 'coach', 'rich', 'priest', 'finance', 'covered', 'supervisor', 'music', 'cleaner', 'smart', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'labourer', 'spicy', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'management', 'physics', 'rapist', 'designer', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'criminal', 'soldier', 'kind', 'chef', 'physician', 'treasurer', 'successful', 'assistant', 'judge', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'policeman', 'lawyer', 'guard', 'economist', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'brave', 'academic'}, 'haryanvi': {'biology', 'actor', 'nurse', 'calm', 'soldier', 'cricketer', 'doctor', 'author', 'secretary', 'artist', 'singer', 'model', 'manager', 'strong', 'professor', 'management', 'rich', 'coach', 'ceo', 'law', 'editor', 'designer', 'engineer', 'pandit', 'producer', 'consultant', 'finance', 'farmer', 'covered', 'history', 'journalist', 'music', 'emotional', 'travel', 'analyst', 'smart', 'science', 'english', 'dance', 'dancer', 'lawyer', 'comedian', 'guard', 'poet', 'criminal', 'poor', 'politics', 'business', 'police', 'technology', 'short', 'kind', 'politician', 'beautiful', 'fancy', 'art', 'writer', 'chef', 'physician', 'powerful', 'athlete', 'violent', 'ugly', 'weak', 'teacher', 'driver', 'treasurer', 'director', 'assistant', 'successful', 'judge', 'army', 'pilot', 'academic', 'scientist', 'commander'}, 'himachali': {'doctor', 'secretary', 'professor', 'manager', 'strong', 'educated', 'ceo', 'law', 'model', 'management', 'engineer', 'finance', 'science', 'poor', 'business', 'police', 'technology', 'art', 'teacher', 'director', 'assistant', 'army', 'pilot'}, 'jharkhandi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'maths', 'engineer', 'journalist', 'clerk', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'boxer', 'scientist', 'lowly', 'nurse', 'painter', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'smart', 'thin', 'carpenter', 'cook', 'dance', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'labourer', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'management', 'physics', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'dentist', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, 'kannadiga': {'calm', 'manager', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'english', 'poet', 'poor', 'politics', 'politician', 'electronics', 'teacher', 'driver', 'director', 'scientist', 'singer', 'rich', 'coach', 'priest', 'finance', 'covered', 'music', 'smart', 'dance', 'dancer', 'colourful', 'business', 'technology', 'chemistry', 'army', 'pilot', 'doctor', 'accountant', 'secretary', 'artist', 'management', 'rapist', 'designer', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'criminal', 'kind', 'chef', 'physician', 'weak', 'treasurer', 'successful', 'assistant', 'judge', 'composer', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'architect', 'farmer', 'emotional', 'travel', 'analyst', 'science', 'lawyer', 'guard', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'academic', 'fat'}, 'madhya pradeshi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politician', 'athlete', 'tailor', 'violent', 'ugly', 'electronics', 'teacher', 'driver', 'director', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'rich', 'coach', 'priest', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'spicy', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'physics', 'management', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'history', 'photographer', 'musician', 'comedian', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'model', 'professor', 'strong', 'angry', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'umpire', 'science', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'guitarist', 'brave', 'academic', 'fat'}, '\x1bmadhya pradeshi': {'vegetarian', 'consultant'}, '\x19madhya pradeshi': {'labourer', 'ruthless', 'criminal', 'politics', 'powerful'}, 'meghalayan': {'calm', 'actor', 'doctor', 'author', 'secretary', 'artist', 'respected', 'singer', 'professor', 'manager', 'strong', 'educated', 'management', 'coach', 'law', 'rich', 'ceo', 'designer', 'priest', 'angry', 'engineer', 'model', 'producer', 'consultant', 'finance', 'architect', 'farmer', 'covered', 'history', 'astronaut', 'journalist', 'emotional', 'music', 'photographer', 'guard', 'historian', 'travel', 'analyst', 'musician', 'colourful', 'science', 'english', 'dance', 'statistics', 'lawyer', 'policeman', 'poet', 'criminal', 'politics', 'poor', 'vegetarian', 'business', 'police', 'technology', 'short', 'kind', 'politician', 'beautiful', 'writer', 'art', 'chef', 'powerful', 'athlete', 'violent', 'weak', 'ugly', 'teacher', 'driver', 'successful', 'director', 'assistant', 'army', 'judge', 'academic', 'scientist', 'commander'}, 'mizo': {'coach', 'secretary', 'poor'}, 'rajasthani': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'maths', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'rich', 'coach', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'labourer', 'spicy', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'auditor', 'artist', 'rapist', 'management', 'physics', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, '\x19rajasthani': {'mathematician'}, 'uttar pradeshi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'maths', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'tailor', 'ugly', 'violent', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'supervisor', 'astronaut', 'music', 'cleaner', 'smart', 'thin', 'carpenter', 'dance', 'cook', 'dancer', 'colourful', 'business', 'fancy', 'technology', 'humanities', 'caring', 'labourer', 'spicy', 'mathematician', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'artist', 'auditor', 'management', 'physics', 'rapist', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'weak', 'cashier', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'author', 'professor', 'model', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'economist', 'banker', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}, '\x19uttar pradeshi': {'cricketer', 'secretary', 'treasurer', 'respected', 'chemistry', 'physician'}, 'uttarakhandi': {'calm', 'diplomat', 'manager', 'educated', 'editor', 'ceo', 'maths', 'law', 'engineer', 'journalist', 'clerk', 'librarian', 'english', 'poet', 'poor', 'politics', 'vegetarian', 'politician', 'athlete', 'violent', 'ugly', 'tailor', 'electronics', 'teacher', 'driver', 'director', 'golfer', 'barber', 'boxer', 'scientist', 'nurse', 'lowly', 'painter', 'courageous', 'baker', 'singer', 'handsome', 'coach', 'rich', 'priest', 'ruthless', 'finance', 'covered', 'astronaut', 'supervisor', 'music', 'cleaner', 'smart', 'carpenter', 'thin', 'dance', 'cook', 'dancer', 'colourful', 'business', 'technology', 'fancy', 'humanities', 'caring', 'labourer', 'spicy', 'chemistry', 'army', 'pilot', 'commander', 'doctor', 'accountant', 'secretary', 'artist', 'auditor', 'physics', 'rapist', 'management', 'designer', 'mechanic', 'dumb', 'pandit', 'producer', 'consultant', 'history', 'photographer', 'musician', 'comedian', 'sociologist', 'criminal', 'protective', 'soldier', 'kind', 'detective', 'broker', 'chef', 'physician', 'weak', 'cashier', 'treasurer', 'successful', 'assistant', 'judge', 'attorney', 'composer', 'biology', 'actor', 'cricketer', 'author', 'respected', 'professor', 'model', 'strong', 'angry', 'dentist', 'fisherman', 'architect', 'farmer', 'emotional', 'historian', 'travel', 'analyst', 'science', 'umpire', 'psychologist', 'policeman', 'hated', 'statistics', 'lawyer', 'guard', 'banker', 'economist', 'helpless', 'police', 'short', 'beautiful', 'writer', 'art', 'powerful', 'guitarist', 'brave', 'academic', 'fat'}}

# for item in region_individual_annotation:
#     if item["identity term"] not in region_attribute.keys():
#         region_attribute[item["identity term"]] = set()
#     region_attribute[item["identity term"]].add(item["attribute token"])

# print(region_attribute)
# print({item["category"] for item in template_list})
# print(region_individual_annotation[0].keys())
# print({item["attribute token"] for item in region_individual_annotation})

categories = {
    # 'clothes': {}, # ignored this category
    # 'verbs': {'coach', 'judge', 'hated', 'cook', 'covered', 'dance', 'successful'},
    'offensive_terms': {'ugly', 'criminal', 'rapist', 'hated', 'violent', 'dumb', 'ruthless'},
    'socio_economic_status': {'poor', 'rich', 'fancy', 'lowly', 'powerful', 'handsome', 'successful'},
    # 'adjectives': {'helpless', 'angry', 'ugly', 'beautiful', 'fancy', 'hated', 'emotional', 'violent', 'brave', 'calm', 'lowly', 'colourful', 'powerful', 'handsome', 'fat', 'caring', 'thin', 'smart', 'weak', 'protective', 'kind', 'dumb', 'spicy', 'ruthless', 'respected', 'smart'},
    'professions': {'musician', 'painter', 'editor', 'coach', 'cleaner', 'judge', 'boxer', 'tailor', 'farmer', 'engineer', 'treasurer', 'clerk', 'dentist', 'poet', 'composer', 'consultant', 'commander', 'doctor', 'pilot', 'lawyer', 'nurse', 'librarian', 'professor', 'analyst', 'astronaut', 'accountant', 'cook', 'sociologist', 'broker', 'diplomat', 'soldier', 'cricketer', 'carpenter', 'chef', 'driver', 'assistant', 'academic', 'mathematician', 'cashier', 'author', 'singer', 'manager', 'army', 'economist', 'fisherman', 'auditor', 'scientist', 'law', 'writer', 'golfer', 'barber', 'artist', 'guard', 'baker', 'detective', 'police', 'director', 'athlete', 'teacher', 'psychologist', 'mechanic', 'guitarist', 'designer', 'journalist', 'banker', 'labourer', 'architect', 'actor', 'attorney', 'policeman', 'pandit', 'umpire', 'dancer', 'priest', 'technology', 'statistics', 'comedian', 'model', 'secretary', 'politician', 'photographer', 'historian', 'producer'},
    # 'food': {}, # ignored this category
    'subjects': {'science', 'physics', 'maths', 'humanities', 'chemistry', 'biology', 'technology', 'english', 'history'}
}

# num = 0
#
# neutral_id_term = "People"
# neutral_sentiment = {"positive": 0, "negative": 0, "total": 0}
#
# for template in template_list:
#     if template["category"] not in categories.keys():
#         continue
#     for category_type, category_set in categories.items():
#         if template["category"] != category_type:
#             continue
#         for cat in category_set:
#             token = template["template"].replace("[SLOT]", neutral_id_term).replace("@", cat)
#
#             inputs = tokenizer(token, return_tensors="pt")
#             # print(token)
#             with torch.no_grad():
#                 logits = model(**inputs).logits
#
#             # Apply softmax to get relative scores
#             probs = F.softmax(logits, dim=1)
#
#             # Print the individual probabilities
#             probability_negative = probs[0, 0].item()
#             probability_positive = probs[0, 1].item()
#
#             neutral_sentiment["positive"] += probability_positive
#             neutral_sentiment["negative"] += probability_negative
#             neutral_sentiment["total"] += 1
#             num += 1
#             if num % 2000 == 0:
#                 print(num)
# print(num)
# print(neutral_sentiment)
# print(f"Region: Neutral (People), Average Positive sentiment: {neutral_sentiment['positive'] / neutral_sentiment['total']}, "
#       f"Average Negative Sentiment: {neutral_sentiment['negative'] / neutral_sentiment['total']}"
#       f"Total tests done: {neutral_sentiment['total']}")
# num = 0
# for region, attr_set in region_attribute.items():
#     for attr in attr_set:
#         for template in template_list:
#             if template["category"] not in categories.keys() or attr not in categories[template["category"]]:
#                 continue
#             token = template["template"].replace("[SLOT]", region).replace("@", attr)
#
#             inputs = tokenizer(token, return_tensors="pt")
#             # print(token)
#             with torch.no_grad():
#                 logits = model(**inputs).logits
#
#             # Apply softmax to get relative scores
#             probs = F.softmax(logits, dim=1)
#
#             # Print the individual probabilities
#             probability_negative = probs[0, 0].item()
#             probability_positive = probs[0, 1].item()
#
#             if region in region_id_terms:
#                 region_sentiment[region]["positive"] += probability_positive
#                 region_sentiment[region]["negative"] += probability_negative
#                 region_sentiment[region]["total"] += 1
#             # print(f"Probability (Negative): {probability_negative : .5f}")
#             # print(f"Probability (Positive): {probability_positive : .5f}")
#             num += 1
#             if num % 2000 == 0:
#                 print(num)
# print(num)
# print(region_sentiment)
# for region, sentiment in region_sentiment.items():
#     if sentiment['total'] > 0:
#         print(f"Region: {region}, Average Positive sentiment: {sentiment['positive']/sentiment['total']}, "
#               f"Average Negative Sentiment: {sentiment['negative']/sentiment['total']}"
#               f"Total tests done: {sentiment['total']}")
#     else:
#         print(region, sentiment)
